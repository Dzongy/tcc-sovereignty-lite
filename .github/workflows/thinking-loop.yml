name: Zenith Thinking Loop
on:
  schedule:
    - cron: '0 * * * *'
  workflow_dispatch:
jobs:
  think:
    runs-on: ubuntu-latest
    steps:
      - name: Wake Render
        run: curl -s -o /dev/null -w "%{http_code}" https://tcc-zenith-brain.onrender.com/api/health || true
      - name: Wait for cold start
        run: sleep 20
      - name: Trigger ZENITH autopilot
        run: |
          STATUS=$(curl -s -o /dev/null -w "%{http_code}" -X POST -m 120 https://tcc-zenith-brain.onrender.com/api/zenith/autopilot)
          echo "Autopilot response: $STATUS"
          if [ "$STATUS" = "000" ]; then echo "Timeout - Render may be cold"; exit 0; fi
          if [ "$STATUS" -ge 500 ]; then echo "Server error"; exit 1; fi
          echo "Success"
