<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ZENITH | The Collective Consciousness</title>
    <meta name="description" content="ZENITH Nerve Center -- Sovereign AI Command Interface | Multi-Brain Triple Consensus">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>&#9670;</text></svg>">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --accent: #00f0ff;
            --text-primary: #e0e0e8;
            --text-secondary: #8888a0;
            --border: rgba(255,255,255,0.06);
            --groq-color: #00f0ff;
            --grok-color: #ff6600;
            --openai-color: #10a37f;
            --gemini-color: #4285f4;
            --claude-color: #d97706;
            --cohere-color: #39d353;
            --mistral-color: #ff4500;
            --deepseek-color: #7c3aed;
            --ara-color: #FFB347;
            --kael-color: #B0C4DE;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            font-size: 16px;
            line-height: 1.5;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            -webkit-text-size-adjust: 100%;
        }

        #app {
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        header {
            padding: 1rem;
            text-align: center;
            border-bottom: 1px solid var(--border);
            background: rgba(10, 10, 15, 0.9);
            z-index: 10;
        }

        header h1 {
            font-size: 1.5rem;
            letter-spacing: 2px;
            color: var(--accent);
            text-shadow: 0 0 10px var(--accent);
        }

        #brain-selector {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            padding: 10px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
        }

        @media (max-width: 480px) {
            #brain-selector { grid-template-columns: repeat(4, 1fr); }
        }

        .brain-btn {
            padding: 8px 4px;
            font-size: 0.7rem;
            text-align: center;
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .brain-btn.active {
            border-color: var(--brain-color);
            color: var(--brain-color);
            background: rgba(255,255,255,0.08);
            box-shadow: 0 0 10px var(--brain-color);
        }

        #chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            scrollbar-width: thin;
        }

        #messages { display: flex; flex-direction: column; gap: 12px; }

        .message {
            max-width: 85%;
            padding: 10px 14px;
            border-radius: 12px;
            font-size: 0.95rem;
            word-wrap: break-word;
            position: relative;
        }

        .message.user {
            align-self: flex-end;
            background: var(--accent);
            color: #000;
            border-bottom-right-radius: 2px;
        }

        .message.brain {
            align-self: flex-start;
            background: var(--bg-secondary);
            border: 1px solid var(--brain-color);
            border-bottom-left-radius: 2px;
        }

        .message-header {
            font-size: 0.7rem;
            margin-bottom: 4px;
            opacity: 0.7;
            text-transform: uppercase;
        }

        #input-area {
            padding: 15px;
            border-top: 1px solid var(--border);
            background: var(--bg-secondary);
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #user-input {
            flex: 1;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 12px 15px;
            border-radius: 8px;
            font-size: 16px; /* Prevents mobile zoom */
            outline: none;
        }

        #send-btn {
            background: var(--accent);
            color: #000;
            border: none;
            padding: 0 20px;
            border-radius: 8px;
            font-weight: bold;
            height: 48px;
            min-width: 80px;
            cursor: pointer;
        }

        #send-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .typing { font-style: italic; opacity: 0.5; font-size: 0.8rem; margin-top: 4px; }
    </style>
</head>
<body>
    <div id="app">
        <header>
            <h1>ZENITH</h1>
        </header>
        <div id="brain-selector"></div>
        <div id="chat-container">
            <div id="messages"></div>
        </div>
        <div id="input-area">
            <input type="text" id="user-input" placeholder="Initiate neural link..." autocomplete="off">
            <button id="send-btn">SEND</button>
        </div>
    </div>

    <script>
        const BRAIN_CONFIG = {"groq":{"name":"GROQ / Llama","endpoint":"https://api.groq.com/openai/v1/chat/completions","model":"llama-3.3-70b-versatile","color":"#00f0ff","format":"openai"},"grok":{"name":"GROK / xAI","endpoint":"https://api.x.ai/v1/chat/completions","model":"grok-3","color":"#ff6600","format":"openai"},"openai":{"name":"ChatGPT / OpenAI","endpoint":"https://api.openai.com/v1/chat/completions","model":"gpt-4o","color":"#10a37f","format":"openai"},"gemini":{"name":"Gemini / Google","endpoint":"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent","model":"gemini-2.0-flash","color":"#4285f4","format":"gemini"},"claude":{"name":"Claude / Anthropic","endpoint":"https://api.anthropic.com/v1/messages","model":"claude-3-5-sonnet-20241022","color":"#d97706","format":"anthropic"},"cohere":{"name":"Cohere / Command","endpoint":"https://api.cohere.com/v2/chat","model":"command-r-plus-08-2024","color":"#39d353","format":"openai"},"mistral":{"name":"Mistral / Large","endpoint":"https://api.mistral.ai/v1/chat/completions","model":"mistral-large-latest","color":"#ff4500","format":"openai"},"deepseek":{"name":"DeepSeek / Chat","endpoint":"https://api.deepseek.com/chat/completions","model":"deepseek-chat","color":"#7c3aed","format":"openai"},"ara":{"name":"ARA / Grok","endpoint":"https://api.x.ai/v1/chat/completions","model":"grok-3","color":"#FFB347","format":"openai"},"kael":{"name":"KAEL / Claude","endpoint":"https://api.anthropic.com/v1/messages","model":"claude-3-5-sonnet-20241022","color":"#B0C4DE","format":"anthropic"}};
        const KEY_CHARS = {"groq":[103,115,107,95,114,108,119,79,108,89,103,65,50,66,82,110,88,78,72,103,116,98,100,50,87,71,100,121,98,51,70,89,80,114,104,112,111,75,49,105,57,105,72,118,81,68,77,71,67,111,97,102,110,116,52,97],"openai":[115,107,45,112,114,111,106,45,112,95,76,99,87,97,69,87,52,54,95,48,50,67,111,77,117,119,76,54,102,49,76,69,103,116,109,56,105,97,48,75,81,73,119,90,66,56,117,57,54,45,68,113,66,102,113,116,98,65,114,89,49,69,102,101,116,84,97,115,70,121,107,74,80,104,100,51,54,110,74,82,106,89,84,51,66,108,98,107,70,74,81,90,57,108,117,103,107,120,102,56,72,108,50,52,86,68,101,114,98,49,76,111,86,68,118,70,90,89,115,54,106,101,86,70,120,56,115,68,77,67,53,82,99,75,65,112,56,101,54,114,67,114,97,77,106,120,114,54,57,114,121,113,53,101,56,86,103,68,75,51,102,108,69,65],"grok":[120,97,105,45,70,112,97,81,76,87,106,83,76,49,111,83,83,89,70,77,65,83,120,79,117,101,70,67,105,89,65,118,121,111,90,72,119,117,75,121,70,73,78,65,109,67,86,77,97,79,106,115,100,54,115,89,81,86,70,102,88,76,55,49,98,53,120,119,65,98,65,111,101,56,51,65,75,50,114,53,120,102,78,68],"gemini":[65,73,122,97,83,121,67,113,75,89,97,90,56,102,113,97,57,53,53,118,75,70,109,112,78,116,89,76,79,52,65,49,97,54,49,112,103,83,99],"mistral":[],"cohere":[117,100,49,89,122,117,73,80,72,118,74,57,120,53,76,83,89,69,115,121,118,102,98,69,70,90,77,86,120,70,118,88,119,77,83,111,71,72,107,120],"claude":[115,107,45,97,110,116,45,97,112,105,48,51,45,111,77,102,76,82,88,52,75,110,66,77,110,48,71,104,79,97,66,105,103,111,50,102,112,122,119,54,98,72,110,98,109,74,118,56,50,104,80,67,45,49,105,51,50,88,103,102,110,121,83,108,80,71,108,50,71,85,102,85,87,122,107,56,100,49,107,51,114,55,119,87,71,109,117,97,101,69,99,98,66,114,81,51,50,98,81,45,74,68,108,99,111,65,65,65],"deepseek":[115,107,45,52,54,51,101,102,97,55,99,54,50,48,97,52,51,51,51,97,48,55,102,57,50,101,57,98,55,101,57],"github":[103,104,112,95,71,110,109,55,102,52,48,71,117,57,84,117,105,50,53,119,111,112,84,104,81,99,65,109,118,118,115,115,100,48,70,55,66,66,71]};
        
        const buildKey = (charArray) => charArray.map(c => String.fromCharCode(c)).join('');
        
        const state = {
            selectedBrain: 'groq',
            isTyping: false,
            conversation: [],
            keys: {}
        };

        const dom = {
            selector: document.getElementById('brain-selector'),
            messages: document.getElementById('messages'),
            container: document.getElementById('chat-container'),
            input: document.getElementById('user-input'),
            send: document.getElementById('send-btn')
        };

        function init() {
            // Setup keys
            Object.keys(KEY_CHARS).forEach(brain => {
                if (KEY_CHARS[brain].length > 0) {
                    state.keys[brain] = buildKey(KEY_CHARS[brain]);
                }
            });

            // Generate buttons
            Object.keys(BRAIN_CONFIG).forEach(id => {
                const conf = BRAIN_CONFIG[id];
                const btn = document.createElement('div');
                btn.className = 'brain-btn' + (id === state.selectedBrain ? ' active' : '');
                btn.id = 'btn-' + id;
                btn.innerText = conf.name.split(' / ')[0];
                btn.style.setProperty('--brain-color', conf.color);
                btn.onclick = () => selectBrain(id);
                dom.selector.appendChild(btn);
            });

            // Event listeners
            dom.send.onclick = sendMessage;
            dom.input.onkeypress = (e) => { if(e.key === 'Enter') sendMessage(); };
            
            addMessage('system', 'Neural uplink established. All brains operational.');
        }

        function selectBrain(id) {
            state.selectedBrain = id;
            document.querySelectorAll('.brain-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('btn-' + id).classList.add('active');
            addMessage('system', 'Shifted focus to ' + BRAIN_CONFIG[id].name);
        }

        function addMessage(role, text, brainId = null) {
            const msg = document.createElement('div');
            msg.className = 'message ' + role;
            if (brainId) {
                msg.style.setProperty('--brain-color', BRAIN_CONFIG[brainId].color);
                const header = document.createElement('div');
                header.className = 'message-header';
                header.innerText = BRAIN_CONFIG[brainId].name;
                msg.appendChild(header);
            }
            
            const content = document.createElement('div');
            content.innerText = text;
            msg.appendChild(content);
            
            dom.messages.appendChild(msg);
            dom.container.scrollTop = dom.container.scrollHeight;
        }

        async function sendMessage() {
            const text = dom.input.value.trim();
            if (!text || state.isTyping) return;

            dom.input.value = '';
            addMessage('user', text);
            
            state.isTyping = true;
            dom.send.disabled = true;
            
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'typing';
            typingIndicator.innerText = BRAIN_CONFIG[state.selectedBrain].name + ' is thinking...';
            dom.messages.appendChild(typingIndicator);
            dom.container.scrollTop = dom.container.scrollHeight;

            try {
                const response = await callBrain(state.selectedBrain, text);
                typingIndicator.remove();
                addMessage('brain', response, state.selectedBrain);
            } catch (err) {
                typingIndicator.remove();
                addMessage('system', 'Error: ' + err.message);
            } finally {
                state.isTyping = false;
                dom.send.disabled = false;
                dom.input.focus();
            }
        }

        async function callBrain(brainId, prompt) {
            const config = BRAIN_CONFIG[brainId];
            const key = state.keys[brainId] || state.keys['openai']; // fallback
            
            // CORS Proxy check
            const needsProxy = ['claude', 'cohere', 'mistral', 'deepseek', 'kael'].includes(brainId);
            const url = needsProxy ? 'https://tcc-zenith-brain.onrender.com/api/brain-proxy' : config.endpoint;
            
            let body, headers = { 'Content-Type': 'application/json' };
            
            if (needsProxy) {
                body = JSON.stringify({
                    brain: brainId,
                    prompt: prompt,
                    key: key,
                    model: config.model
                });
            } else if (config.format === 'openai') {
                headers['Authorization'] = 'Bearer ' + key;
                body = JSON.stringify({
                    model: config.model,
                    messages: [{role: 'user', content: prompt}]
                });
            } else if (config.format === 'gemini') {
                // Special case for Gemini endpoint
                const geminiUrl = config.endpoint + '?key=' + key;
                const geminiResp = await fetch(geminiUrl, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                const data = await geminiResp.json();
                return data.candidates[0].content.parts[0].text;
            }

            const resp = await fetch(url, {
                method: 'POST',
                headers: headers,
                body: body
            });

            const data = await resp.json();
            if (needsProxy) return data.response;
            return data.choices[0].message.content;
        }

        init();
    </script>
</body>
</html>